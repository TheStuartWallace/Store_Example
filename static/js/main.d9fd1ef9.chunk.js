(this.webpackJsonpstore_example=this.webpackJsonpstore_example||[]).push([[0],{34:function(e,t,a){e.exports=a(52)},40:function(e,t,a){},52:function(e,t,a){"use strict";a.r(t);var n=a(1),r=a.n(n),s=a(6),c=a(2),i=a(3),o=a(5),l=a(4),u=a(0),d=a.n(u),m=a(31),p=a.n(m),h=(a(40),a(8)),v=a(7),f=a(25),g=a.n(f);a(41),a(45),a(53);g.a.initializeApp({apiKey:"AIzaSyD3EtMzgHnjYat2LbYjYGJi6goQ72UpqLQ",authDomain:"storeexample-1c12e.firebaseapp.com",databaseURL:"https://storeexample-1c12e.firebaseio.com",projectId:"storeexample-1c12e",storageBucket:"storeexample-1c12e.appspot.com",messagingSenderId:"113670337584",appId:"1:113670337584:web:837407a10474f3a3fea9f5"});var b=g.a,E=a(16),y=d.a.createContext(null),k=function(e){Object(o.a)(a,e);var t=Object(l.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).state={currentUser:void 0,storeData:void 0,orderHistory:void 0},n.loadStoreData=n.loadStoreData.bind(Object(E.a)(n)),n.loadData=n.loadData.bind(Object(E.a)(n)),n}return Object(i.a)(a,[{key:"componentDidMount",value:function(){var e=this;b.auth().onAuthStateChanged((function(t){e.setState({currentUser:t}),null!==t&&(e.loadData(t.uid).then((function(t){e.setState({userData:t})})),e.loadOrderHistory(t.uid).then((function(t){e.setState({orderHistory:t})})))})),this.loadStoreData().then((function(t){e.setState({storeData:t})}))}},{key:"loadData",value:function(){var e=Object(s.a)(r.a.mark((function e(t){var a,n;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b.firestore().collection("userData").doc(t);case 2:return a=e.sent,e.next=5,a.get();case 5:return n=e.sent,e.abrupt("return",n.data());case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"loadOrderHistory",value:function(){var e=Object(s.a)(r.a.mark((function e(t){var a,n,s;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b.firestore().collection("adminData").where("uid","==",t).get();case 2:return a=e.sent,n=a.docs.map((function(e){return e.data()})),s=a.docs.map((function(e){return e.id})),n.map((function(e,t){return n[t].id=s[t]})),e.abrupt("return",n);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"loadStoreData",value:function(){var e=Object(s.a)(r.a.mark((function e(){var t,a,n;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b.firestore().collection("storeSettings").get();case 2:return t=e.sent,a=t.docs.map((function(e){return e.data()})),n=t.docs.map((function(e){return e.id})),a.map((function(e,t){return a[t].id=n[t]})),e.abrupt("return",a);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"loadProductList",value:function(){var e=Object(s.a)(r.a.mark((function e(){var t,a;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b.firestore.collection("productList").get();case 2:return t=e.sent,a=t.get(),e.abrupt("return",a.data());case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){return d.a.createElement(y.Provider,{value:this.state},this.props.children)}}]),a}(d.a.Component),N=a(15),O=a(9),x=function(e){Object(o.a)(a,e);var t=Object(l.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).state={redirect:null},n.props.data.quantity=0,n.props.data.displayPrice=n.props.data.productPrice/100,n}return Object(i.a)(a,[{key:"addToBasket",value:function(){var e=JSON.parse(window.localStorage.getItem("basket"));this.addBasketItem(e),window.localStorage.setItem("basket",JSON.stringify(e)),this.setState({redirect:!0})}},{key:"addBasketItem",value:function(e){for(var t=0;t<e.length;t++)if(void 0!==e[t]&&e[t].id===this.props.data.id)return console.log(parseInt(e[t].quantity)+1),void(e[t].quantity=parseInt(e[t].quantity)+1);e.push(this.props.data),e[e.length-1].quantity=1}},{key:"render",value:function(){var e=this;return this.state.redirect?d.a.createElement(v.a,{to:"/basket"}):d.a.createElement("div",{className:"sliWrapper"},d.a.createElement(h.b,{to:"/products/".concat(this.props.data.id),className:"sli"},d.a.createElement("img",{className:"sliImage",src:this.props.data.image,alt:this.props.data.productName}),d.a.createElement("div",{className:"sliTitle"},JSON.parse(this.props.data.productName)),d.a.createElement("div",{className:"sliPrice"},"\xa3",this.props.data.displayPrice),d.a.createElement("button",{className:"sliBuy",onClick:function(){return e.addToBasket()}},"Buy Now")))}}]),a}(d.a.Component),S=function(e){Object(o.a)(a,e);var t=Object(l.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).state={status:1,basketAmount:n.getTotal()},n}return Object(i.a)(a,[{key:"getTotal",value:function(){for(var e=JSON.parse(window.localStorage.getItem("basket")),t=0,a=0;a<e.length;a++)t+=parseInt(e[a].quantity);return t}},{key:"render",value:function(){return 0===this.state.status?d.a.createElement("div",{className:"navWrapper"},"Loading..."):d.a.createElement("div",{className:"navWrapper"},d.a.createElement(h.b,{className:"navLink",to:"/"},d.a.createElement("button",{className:"navButtonHome"},d.a.createElement("span",{className:"navLinkButtonText"},"Home"),d.a.createElement("img",{className:"navLinkButtonImage",alt:"Home Navigation Button",src:"https://firebasestorage.googleapis.com/v0/b/storeexample-1c12e.appspot.com/o/HomeAlt.svg?alt=media&token=d71028d0-a3a6-491f-8690-7193f5289cb5"}))),d.a.createElement(h.b,{className:"navLink",to:"/products/"},d.a.createElement("button",{className:"navButtonCatagories"},d.a.createElement("span",{className:"navLinkButtonText"},"Products"),d.a.createElement("img",{className:"navLinkButtonImage",alt:"Product Navigation Button",src:"https://firebasestorage.googleapis.com/v0/b/storeexample-1c12e.appspot.com/o/ProductsAlt.svg?alt=media&token=686777dc-56a5-4e92-9f13-25121f7b5030"}))),d.a.createElement("span",{className:"navTitle"},this.context.storeData[1].StoreTitle),void 0===this.context.userData||null===this.context.userData?d.a.createElement(h.b,{className:"navLink",to:"/signin"},d.a.createElement("button",{className:"navButtonBasket"},d.a.createElement("span",{className:"navLinkButtonText"},"Sign in"),d.a.createElement("img",{className:"navLinkButtonImage",alt:"Sign In Navigation Button",src:"https://firebasestorage.googleapis.com/v0/b/storeexample-1c12e.appspot.com/o/AccountAlt.svg?alt=media&token=37d726f9-dbf1-40a7-a342-aa6a3262ab61"}))):d.a.createElement(h.b,{className:"navLink",to:"/account"},d.a.createElement("button",{className:"navButtonBasket"},d.a.createElement("span",{className:"navLinkButtonText"},this.context.userData.displayName,"'s account"),d.a.createElement("img",{className:"navLinkButtonImage",alt:"Account Navigation Button",src:"https://firebasestorage.googleapis.com/v0/b/storeexample-1c12e.appspot.com/o/AccountAlt.svg?alt=media&token=37d726f9-dbf1-40a7-a342-aa6a3262ab61"}))),d.a.createElement(h.b,{className:"navLink",to:"/basket"},d.a.createElement("button",{className:"navButtonBasket"},d.a.createElement("span",{className:"navLinkButtonText"},"Basket (",this.state.basketAmount,")"),d.a.createElement("img",{className:"navLinkButtonImage",alt:"Basket Navigation Button",src:"https://firebasestorage.googleapis.com/v0/b/storeexample-1c12e.appspot.com/o/BasketAlt.svg?alt=media&token=9c8a999c-0278-4419-b5ea-111a69866065"}))))}}]),a}(d.a.Component);S.contextType=y;var C=S,P=function(e){Object(o.a)(a,e);var t=Object(l.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(i.a)(a,[{key:"render",value:function(){return d.a.createElement("div",{className:"LoadingScreenWrapper"},d.a.createElement("span",{className:"LoadingScreenMessage"},"Loading..."))}}]),a}(d.a.Component),D=function(e){Object(o.a)(a,e);var t=Object(l.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).state={status:0},n}return Object(i.a)(a,[{key:"componentDidUpdate",value:function(){if(void 0!==this.context&&void 0!==this.context.storeData&&0===this.state.status){var e=Object.keys(this.context.storeData[0]),t=Object.values(this.context.storeData[0]),a=e.indexOf("id");e.splice(a,1),t.splice(a,1),this.setState({listKeys:e,listValue:t,status:1})}}},{key:"render",value:function(){var e=this;switch(this.state.status){case-1:default:return d.a.createElement("div",{className:"catWrapper"},"Error");case 0:return d.a.createElement(P,null);case 1:return d.a.createElement("div",{className:"catWrapper"},d.a.createElement("div",{className:"catList"},Object.keys(this.state.listKeys).map((function(t,a){return d.a.createElement("div",{key:a,className:"catListTag"},d.a.createElement("input",{type:"checkbox",id:e.state.listKeys[a],name:"Catagorys",className:"catCheck",onChange:function(t){return e.props.handleSearch(t)}}),d.a.createElement("label",{className:"catLabel",htmlFor:e.state.listKeys[a]},e.state.listKeys[a]))}))))}}}]),a}(d.a.Component);D.contextType=y;var I=D,w=function(){function e(){Object(c.a)(this,e)}return Object(i.a)(e,null,[{key:"getProductInfo",value:function(){var e=Object(s.a)(r.a.mark((function e(t){var a;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b.firestore().collection("productList").doc(t).get();case 2:return a=e.sent,e.abrupt("return",a.exists?a.data():null);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"setProductInfo",value:function(){var e=Object(s.a)(r.a.mark((function e(t,a){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:b.firestore().collection("productList").doc(t).update(a);case 1:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}()},{key:"getProductList",value:function(){var e=Object(s.a)(r.a.mark((function e(){var t,a,n;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b.firestore().collection("productList").get();case 2:return t=e.sent,a=t.docs.map((function(e){return e.data()})),n=t.docs.map((function(e){return e.id})),a.map((function(e,t){return a[t].id=n[t]})),e.abrupt("return",a);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"getUserData",value:function(){var e=Object(s.a)(r.a.mark((function e(t){var a,n;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b.firestore().collection("userData").doc(t);case 2:return a=e.sent,e.next=5,a.get();case 5:return n=e.sent,e.abrupt("return",n.data());case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"getUserOrderHistory",value:function(){var e=Object(s.a)(r.a.mark((function e(t){var a;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b.firestore().collection("adminData").where("uid","==",t).get();case 2:return a=e.sent,e.abrupt("return",a.docs.map((function(e){return e.data()})));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"getUserOrder",value:function(){var e=Object(s.a)(r.a.mark((function e(t){var a;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b.firestore().collection("adminData").doc(t).get();case 2:return a=e.sent,e.abrupt("return",a.data());case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"getStoreSettings",value:function(){var e=Object(s.a)(r.a.mark((function e(){var t,a,n;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b.firestore().collection("storeSettings").get();case 2:return t=e.sent,a=t.docs.map((function(e){return e.data()})),n=t.docs.map((function(e){return e.id})),a.map((function(e,t){return a[t].id=n[t]})),e.abrupt("return",a);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"addOrderHistory",value:function(){var e=Object(s.a)(r.a.mark((function e(t,a,n,s){var c,i,o;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(c=[],i=0;i<a.length;i++)c.push(JSON.stringify({key:a[i].id,quantity:a[i].quantity}));o={name:s.card.name,email:s.email,address:{name:s.card.name,line1:s.card.address_line1,line2:s.card.address_line2,city:s.card.address_city,postcode:s.card.address_zip},data:c,created:b.firestore.FieldValue.serverTimestamp(),status:0,uid:t,token:s.id,paid:n},b.firestore().collection("adminData").doc(s.id).set(o).catch((function(e){window.alert("There was an issue placing this order, please contact support"),console.error("Unable to write to admin panel! ("+e+")")}));case 4:case"end":return e.stop()}}),e)})));return function(t,a,n,r){return e.apply(this,arguments)}}()},{key:"setOrderRefunded",value:function(){var e=Object(s.a)(r.a.mark((function e(t){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b.firestore().collection("adminData").doc(t).update({status:4});case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"getAdminData",value:function(){var e=Object(s.a)(r.a.mark((function e(){var t,a,n;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b.firestore().collection("adminData").where("status","<",3).get().catch((function(e){alert(e),console.log(e)}));case 2:return t=e.sent,a=t.docs.map((function(e){return e.data()})),n=t.docs.map((function(e){return e.id})),a.map((function(e,t){return a[t].id=n[t]})),a.sort((function(e,t){return e.created>t.created?1:t.created>e.created?-1:0})),e.abrupt("return",a);case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"setProductImage",value:function(){var e=Object(s.a)(r.a.mark((function e(t,a){var n,s,c,i,o;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=b.storage().ref(),s=a.target.files[0],c={contentType:s.type},i=t,o=n.child(i).put(s,c),e.next=7,o;case 7:return e.abrupt("return",e.sent);case 8:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}()},{key:"advanceOrder",value:function(){var e=Object(s.a)(r.a.mark((function e(t){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:b.firestore().collection("adminData").doc(t.id).update({status:t.status+1}).catch((function(e){console.error(e)}));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"saveSettings",value:function(){var e=Object(s.a)(r.a.mark((function e(t){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:b.firestore().collection("storeSettings").doc("StoreSettings").update(t).catch((function(e){console.error(e)}));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"resetPassword",value:function(){var e=Object(s.a)(r.a.mark((function e(t){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b.auth().sendPasswordResetEmail(t);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}]),e}(),j=function(e){Object(o.a)(a,e);var t=Object(l.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).state={status:0},n.serverData=[],n.dataList=[],n.searchInput=d.a.createRef(),n}return Object(i.a)(a,[{key:"componentDidUpdate",value:function(){this.runCheck()}},{key:"componentDidMount",value:function(){this.runCheck()}},{key:"runCheck",value:function(){var e=this;void 0!==this.context&&void 0!==this.context.storeData&&0===this.state.status&&w.getProductList().then((function(t){e.serverData=t,e.dataList=t;var a,n={};for(a in e.context.storeData[0])n=Object(O.a)(Object(O.a)({},n),{},Object(N.a)({},a,!1));e.setState({dataList:n,status:1})}))}},{key:"search",value:function(e){this.setState({status:0});var t=e.target.value.toLowerCase();this.state.catagorys?(this.searchCatagory(),this.dataList=this.dataList.filter((function(e){return e.productName.toLowerCase().includes(t)}))):this.dataList=this.serverData.filter((function(e){return e.productName.toLowerCase().includes(t)})),this.setState({status:1})}},{key:"searchCatagory",value:function(){this.setState({status:0});var e=this,t=Object.keys(this.state.dataList).filter((function(t){return e.state.dataList[t]}));if(0===t.length)return this.dataList=this.serverData,void this.setState({status:1,catagorys:!1});this.dataList=this.serverData.filter((function(e){return JSON.parse(e.Catagory).split("+").some((function(e){return t.includes(e)}))})),this.setState({status:1,catagorys:!0})}},{key:"handleCatagoryList",value:function(e){var t=this;this.setState({dataList:Object(O.a)(Object(O.a)({},this.state.dataList),{},Object(N.a)({},e.target.id,e.target.checked))},(function(){return t.searchCatagory()}))}},{key:"render",value:function(){var e=this;return d.a.createElement("div",{className:"schWrapper"},d.a.createElement(C,null),d.a.createElement("div",{className:"schContainer"},d.a.createElement("div",{className:"schLeft"},d.a.createElement(I,{handleSearch:function(t){return e.handleCatagoryList(t)}})),d.a.createElement("div",{className:"schRight"},d.a.createElement("input",{type:"text",className:"schInput",placeholder:"Search...",onChange:function(t){return e.search(t)}}),d.a.createElement("br",null),d.a.createElement("div",{className:"schResult"},this.dataList.map((function(e,t){return d.a.createElement(x,{key:t,data:e})}))))))}}]),a}(d.a.Component);j.contextType=y;var L=j,B=function(e){Object(o.a)(a,e);var t=Object(l.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).data=[],n.state={status:0,redirect:!1},n.openExpandedImage=n.openExpandedImage.bind(Object(E.a)(n)),n.addToBasket=n.addToBasket.bind(Object(E.a)(n)),n}return Object(i.a)(a,[{key:"componentDidMount",value:function(){this.props.id&&this.getData()}},{key:"getData",value:function(){var e=this;this.setState({status:0}),this.loadData().then((function(t){e.data=t,e.data.id=e.props.id,e.data.quantity=0,e.data.displayPrice=e.data.productPrice/100,console.log(e.data),e.setState({status:1})}))}},{key:"addToBasket",value:function(){var e=JSON.parse(window.localStorage.getItem("basket"));this.addBasketItem(e),window.localStorage.setItem("basket",JSON.stringify(e)),this.setState({redirect:!0})}},{key:"addBasketItem",value:function(e){for(var t=0;t<e.length;t++)if(void 0!==e[t]&&e[t].id===this.data.id)return void(e[t].quantity=parseInt(e[t].quantity)+1);e.push(this.data),e[e.length-1].quantity=parseInt(e[e.length-1].quantity)+1}},{key:"loadData",value:function(){var e=Object(s.a)(r.a.mark((function e(){var t;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b.firestore().collection("productList").doc(this.props.id).get();case 2:return t=e.sent,e.abrupt("return",t.exists?t.data():null);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"openExpandedImage",value:function(){window.open(this.data.image)}},{key:"render",value:function(){var e=this;return console.log(this.data),this.state.redirect?d.a.createElement(v.a,{to:"/basket"}):0===this.state.status?d.a.createElement("div",{className:"sipWrapper"},"Loading product information"):1===this.state.status?null!==this.data?d.a.createElement("div",{className:"storeItemPageWrapper"},d.a.createElement(C,null),d.a.createElement("div",{className:"sipWrapper"},d.a.createElement("div",{className:"sipLeft"},d.a.createElement("div",{contentEditable:"true",className:"sipName"},JSON.parse(this.data.productName)),d.a.createElement("br",null),d.a.createElement("img",{onClick:function(){return window.open(e.data.image,"popup","scrollbars=no")},className:"sipImage",src:this.data.image,alt:"".concat(this.data.productName)})),d.a.createElement("div",{className:"sipRight"},d.a.createElement("div",{className:"sipInfo"},d.a.createElement("div",{className:"sipDesc"},JSON.parse(this.data.productDescription).split("\n").map((function(e,t){return d.a.createElement("span",null,e,d.a.createElement("br",null))}))),d.a.createElement("div",{className:"sipBuyBox"},d.a.createElement("div",{className:"sipBoxPrice"},d.a.createElement("span",{className:"sipPrice"},"\xa3",this.data.displayPrice),d.a.createElement("br",null),d.a.createElement("span",{className:"sipItemPP"},"(\xa3",(this.data.deliveryPrice/100).toFixed(2)," P&P)"))),d.a.createElement("div",{className:"sipBuyWrapper"},d.a.createElement("button",{className:"sipBuyButton",onClick:this.addToBasket},"Add to basket")))))):d.a.createElement("div",{className:"storeItemPage"},"No product found"):void 0}}]),a}(d.a.Component);B.contextType=y;var T=B,J=function(e){Object(o.a)(a,e);var t=Object(l.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(i.a)(a,[{key:"render",value:function(){return this.props.match.params.id?d.a.createElement(T,{id:this.props.match.params.id}):d.a.createElement(L,null)}}]),a}(d.a.Component),A=a(33),H=Object(A.a)("pk_test_51HHEl2HbWsI0wL0616xJL9FkVOSuvpDFAfYvYfwwmOv044YOH4npf2jEko9ISFcouW3Y5ETqkQMWxeizaDANXNTL0018qa39p8"),W=function(e){Object(o.a)(a,e);var t=Object(l.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).state={storedItems:JSON.parse(window.localStorage.getItem("basket"))},n}return Object(i.a)(a,[{key:"componentDidMount",value:function(){this.calculateTotal()}},{key:"calculateTotal",value:function(){for(var e=0,t=0;t<this.state.storedItems.length;t++)e+=this.state.storedItems[t].productPrice*this.state.storedItems[t].quantity,e+=this.state.storedItems[t].deliveryPrice*this.state.storedItems[t].quantity;this.setState({grandTotal:e})}},{key:"removeItem",value:function(e){var t=this;if(window.confirm("This will remove all of this item from your basket, are you sure?")){for(var a=this.state.storedItems,n=0;n<a.length;n++)a[n].id===e.target.id&&a.splice(n,1);this.setState({storedItems:a},(function(){window.localStorage.setItem("basket",JSON.stringify(t.state.storedItems))})),this.calculateTotal()}}},{key:"changeBasketItemQuantity",value:function(e){var t=this;e.target.value=e.target.value.replace(".",""),e.target.value=e.target.value.replace(",",""),e.target.value=e.target.value.replace(" ","");for(var a=this.state.storedItems,n=0;n<a.length;n++)if(a[n].id===e.target.id){a[n].quantity=e.target.value;break}this.setState({storedItems:a},(function(){window.localStorage.setItem("basket",JSON.stringify(t.state.storedItems))})),this.calculateTotal()}},{key:"getBasketData",value:function(){for(var e=[],t=0;t<this.state.storedItems.length;t++)e.push({key:this.state.storedItems[t].id,quantity:this.state.storedItems[t].quantity});return JSON.stringify(e)}},{key:"parseData",value:function(){for(var e=[],t=0;t<this.state.storedItems.length;t++)e.push({name:JSON.parse(this.state.storedItems[t].productName),quantity:this.state.storedItems[t].quantity,price:this.state.storedItems[t].productPrice});return console.log(e),JSON.stringify(e)}},{key:"handleClick",value:function(){var e=Object(s.a)(r.a.mark((function e(t){var a,n,s;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,H;case 2:return a=e.sent,e.next=5,fetch("https://www.bystuart.co.uk/store-example/checkout-session",{method:"POST",body:JSON.stringify({uid:btoa(this.context.currentUser.uid),data:btoa(this.parseData()),throughdata:btoa(this.getBasketData())})});case 5:return n=e.sent,e.next=8,n.json();case 8:return s=e.sent,e.next=11,a.redirectToCheckout({sessionId:s.id});case 11:e.sent.error&&console.error(n.text());case 13:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return d.a.createElement("div",{className:"basketWrapper"},d.a.createElement(C,null),d.a.createElement("div",{className:"basketContainer"},d.a.createElement("div",{className:"basketTopBar"},"My Basket"),d.a.createElement("div",{className:"basketList"},this.state.storedItems.map((function(t,a){return d.a.createElement("div",{className:"basketListItem",key:a},d.a.createElement("div",{className:"basketListItemImageCont"},d.a.createElement("img",{className:"basketListItemImage",alt:"Store Item",src:t.image})),d.a.createElement("div",{className:"basketListItemName"},JSON.parse(t.productName)),d.a.createElement("div",{className:"basketListItemPrice"},d.a.createElement("div",{className:"basketListItemPriceMain"},"\xa3",(t.productPrice*t.quantity/100).toFixed(2)),d.a.createElement("div",{className:"basketListItemPriceDelivery"},"\xa3",(t.deliveryPrice*t.quantity/100).toFixed(2))),d.a.createElement("div",{className:"basketListItemQuantity"},d.a.createElement("input",{type:"number",className:"basketListItemQuantityInput",id:t.id,min:"1",max:"99",defaultValue:t.quantity,onChange:function(t){return e.changeBasketItemQuantity(t)}})),d.a.createElement("div",{className:"basketListItemRemove"},d.a.createElement("input",{type:"submit",id:t.id,className:"basketListItemQuantityRemove",value:"\u2717",onClick:function(t){return e.removeItem(t)}})))}))),d.a.createElement("div",{className:"basketBottomBar"},"Your total comes to \xa3",(this.state.grandTotal/100).toFixed(2),d.a.createElement("button",{className:"basketCheckoutButton",role:"link",onClick:function(t){return e.handleClick(t)}},"Proceed to Checkout"))))}}]),a}(d.a.Component);W.contextType=y;var q=W,R=function(e){Object(o.a)(a,e);var t=Object(l.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).state={redirect:!1,email:atob(n.props.location.search.split("=")[1])},window.localStorage.setItem("basket",JSON.stringify([])),n}return Object(i.a)(a,[{key:"render",value:function(){return this.state.redirect?d.a.createElement(v.a,{to:"/"}):d.a.createElement(h.b,{to:"/"},d.a.createElement("div",{className:"CheckoutSuccessWrapper"},d.a.createElement(C,null),d.a.createElement("div",{className:"CheckoutSuccess"},"Hello, ",this.state.email,"!",d.a.createElement("br",null),d.a.createElement("br",null),"Since this is an example store, no actual payment was taken.",d.a.createElement("br",null),d.a.createElement("br",null),"Click anywhere to return home.")))}}]),a}(d.a.Component);R.contextType=y;var U=R,M=function(e){Object(o.a)(a,e);var t=Object(l.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).state={redirect:!1},n}return Object(i.a)(a,[{key:"render",value:function(){return this.state.redirect?d.a.createElement(v.a,{to:"/"}):d.a.createElement(h.b,{to:"/"},d.a.createElement("div",{className:"CheckoutSuccessWrapper"},d.a.createElement(C,null),d.a.createElement("div",{className:"CheckoutSuccess"},"Unfortunately an error has occured or the action was cancelled.",d.a.createElement("br",null),d.a.createElement("br",null),"Click anywhere to return home.")))}}]),a}(d.a.Component);M.contextType=y;var F=M,Y=function(e){Object(o.a)(a,e);var t=Object(l.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).state={status:-1},n}return Object(i.a)(a,[{key:"componentDidUpdate",value:function(){void 0!==this.context&&void 0!==this.context.storeData&&-1===this.state.status&&this.setState({status:0})}},{key:"componentDidMount",value:function(){void 0!==this.context&&void 0!==this.context.storeData&&-1===this.state.status&&this.setState({status:0})}},{key:"render",value:function(){switch(this.state.status){case-1:default:return d.a.createElement(P,null);case 0:return d.a.createElement("div",{className:"PageWrapper"},d.a.createElement(C,null),d.a.createElement("div",{className:"MainPageColumnWrapper"},d.a.createElement(h.b,{to:this.context.storeData[1].ColumnLinkLeft,className:"MainPageColumnLeft"},d.a.createElement("div",{className:"MainPageColumn",style:{background:this.context.storeData[1].ColumnBackgroundLeft}},d.a.createElement("img",{className:"MainPageColumnImage",src:this.context.storeData[1].ColumnImageLeft,alt:this.context.storeData[1].ColumnAltLeft}))),d.a.createElement(h.b,{to:this.context.storeData[1].ColumnLinkCenter,className:"MainPageColumnCenter"},d.a.createElement("div",{className:"MainPageColumn",style:{background:this.context.storeData[1].ColumnBackgroundCenter}},d.a.createElement("img",{className:"MainPageColumnImage",src:this.context.storeData[1].ColumnImageCenter,alt:this.context.storeData[1].ColumnAltCenter}))),d.a.createElement(h.b,{to:this.context.storeData[1].ColumnLinkRight,className:"MainPageColumnRight"},d.a.createElement("div",{className:"MainPageColumn",style:{background:this.context.storeData[1].ColumnBackgroundRight}},d.a.createElement("img",{className:"MainPageColumnImage",src:this.context.storeData[1].ColumnImageRight,alt:this.context.storeData[1].ColumnAltRight})))))}}}]),a}(d.a.Component);Y.contextType=y;var Q=Y,_=function(e){Object(o.a)(a,e);var t=Object(l.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).state={redirect:null},n.handleSignIn=n.handleSignIn.bind(Object(E.a)(n)),n}return Object(i.a)(a,[{key:"handleSignIn",value:function(){var e=Object(s.a)(r.a.mark((function e(t){var a,n,s;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),a=t.target.elements,n=a.email,s=a.password,e.prev=2,e.next=5,b.auth().signInWithEmailAndPassword(n.value,s.value);case 5:this.setState({redirect:!0}),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(2),alert(e.t0);case 11:case"end":return e.stop()}}),e,this,[[2,8]])})));return function(t){return e.apply(this,arguments)}}()},{key:"render",value:function(){return null!==this.state.redirect?d.a.createElement(v.a,{to:"/"}):d.a.createElement("div",{className:"SignInWrapper"},d.a.createElement(C,null),d.a.createElement("form",{onSubmit:this.handleSignIn},d.a.createElement("label",null,"Email",d.a.createElement("br",null),d.a.createElement("input",{type:"email",name:"email",placeholder:"example@example.com"})),d.a.createElement("br",null),d.a.createElement("br",null),d.a.createElement("label",null,"Password",d.a.createElement("br",null),d.a.createElement("input",{type:"password",name:"password",placeholder:"password"})),d.a.createElement("br",null),d.a.createElement("br",null),d.a.createElement("button",{type:"submit"},"Sign in")))}}]),a}(d.a.Component),G=function(e){Object(o.a)(a,e);var t=Object(l.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).state={currentPage:0,maxPages:n.props.maxPages},n}return Object(i.a)(a,[{key:"prevPage",value:function(){var e=this;this.state.currentPage-1>=0&&this.setState({currentPage:this.state.currentPage-1},(function(){e.props.onPageChange(e.state.currentPage)}))}},{key:"nextPage",value:function(){var e=this;this.state.currentPage+1<this.state.maxPages&&this.setState({currentPage:this.state.currentPage+1},(function(){e.props.onPageChange(e.state.currentPage)}))}},{key:"render",value:function(){var e=this,t=[];t.push(d.a.createElement("div",{key:"leftCap",onClick:function(){return e.prevPage()},className:"GlobalNavBallLeftCap"}));for(var a=function(a){t.push(d.a.createElement("div",{onClick:function(){return e.setState({currentPage:a},(function(){e.props.onPageChange(e.state.currentPage)}))},key:a,className:a===e.state.currentPage?"GlobalNavBallFilled":"GlobalNavBall"}))},n=0;n<this.state.maxPages;n++)a(n);return t.push(d.a.createElement("div",{key:"rightCap",onClick:function(){return e.nextPage()},className:"GlobalNavBallRightCap"})),d.a.createElement("div",{className:"GlobalPageNavigation"},t)}}]),a}(d.a.Component),K=function(e){Object(o.a)(a,e);var t=Object(l.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).state={status:0,showPage:0,maxPages:2,resetSent:!1,orderHistory:void 0,orderStatus:["Placed","Dispatched","Out for delivery","Complete","Returned"]},n}return Object(i.a)(a,[{key:"componentDidUpdate",value:function(){var e=this;void 0!==this.context.currentUser&&void 0!==this.context.storeData&&void 0!==this.context.orderHistory&&void 0!==this.context.userData&&void 0===this.state.orderHistory&&this.setState({orderHistory:[]},(function(){return e.processOrderHistory()}))}},{key:"componentDidMount",value:function(){var e=this;void 0!==this.context.currentUser&&void 0!==this.context.storeData&&void 0!==this.context.orderHistory&&void 0!==this.context.userData&&void 0===this.state.orderHistory&&this.setState({orderHistory:[]},(function(){return e.processOrderHistory()}))}},{key:"resetPassword",value:function(){var e=Object(s.a)(r.a.mark((function e(){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:w.resetPassword(this.context.currentUser.email),this.setState({resetSent:!0});case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"processOrderHistory",value:function(){var e=Object(s.a)(r.a.mark((function e(){var t,a,n=this;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=r.a.mark((function e(t){var a,s,c,i,o;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=[],s=n.context.orderHistory[t],c=r.a.mark((function e(t){var n;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=JSON.parse(s.data[t]),e.next=3,w.getProductInfo(n.key).then((function(e){a.push(Object(O.a)(Object(O.a)({},e),{},{productName:JSON.parse(e.productName),sku:JSON.parse(e.sku),productDescription:JSON.parse(e.productDescription),Catagory:JSON.parse(e.Catagory),quantity:n.quantity}))}));case 3:case"end":return e.stop()}}),e)})),i=0;case 4:if(!(i<s.data.length)){e.next=9;break}return e.delegateYield(c(i),"t0",6);case 6:i++,e.next=4;break;case 9:(o=n.state.orderHistory).push(a),n.setState({orderHistory:o});case 12:case"end":return e.stop()}}),e)})),a=0;case 2:if(!(a<this.context.orderHistory.length)){e.next=7;break}return e.delegateYield(t(a),"t0",4);case 4:a++,e.next=2;break;case 7:this.setState({status:1});case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"renderPanel",value:function(){var e=this;switch(this.state.showPage){case 0:default:return d.a.createElement("div",{className:"accPanel"},d.a.createElement("div",{className:"accPanelTitle"},"Display Settings"),d.a.createElement("div",{className:"accPanelItem"},d.a.createElement("label",{htmlFor:"accDisplayName"},"Display Name"),d.a.createElement("br",null),d.a.createElement("input",{id:"accDisplayName",className:"accPanelInput",type:"text",name:"displayName",defaultValue:this.context.userData.displayName})),d.a.createElement("div",{className:"accPanelItem"},d.a.createElement("label",{htmlFor:"accEmail"},"Email"),d.a.createElement("br",null),d.a.createElement("input",{id:"accEmail",className:"accPanelInput",type:"text",name:"displayName",defaultValue:this.context.currentUser.email})),d.a.createElement("div",{className:"accPanelItem"},d.a.createElement("label",{htmlFor:"accResetPassword"},"Password"),d.a.createElement("br",null),d.a.createElement("button",{id:"accResetPassword",className:"accPanelButton",disabled:this.state.resetSent,onClick:function(){return e.resetPassword()}},"Change Password")));case 1:return d.a.createElement("div",{className:"accPanel",style:{"justify-content":"initial"}},d.a.createElement("div",{className:"accPanelTitle"},"Order History"),d.a.createElement("br",null),this.context.orderHistory.map((function(t,a){return d.a.createElement(h.b,{className:"accPanelItem",to:"/account/order/"+t.id},d.a.createElement("div",{className:"accPanelItem",key:a},d.a.createElement("div",{class:"GlobalSpacer"}),d.a.createElement("span",{className:"accOHItemPlaced"},"Placed: ",t.created.toDate().toDateString()),d.a.createElement("br",null),e.state.orderHistory[a].map((function(e,t){return d.a.createElement("div",{className:"accOHItemInfo",key:t},"Item #",t+1," - ",e.productName,"(",e.quantity,")")})),d.a.createElement("span",{className:"accOHItemStatus"},"Status: ",e.state.orderStatus[t.status]),d.a.createElement("br",null),d.a.createElement("span",{className:"accOHItemTotal"},"Paid: \xa3",t.paid/100)))})))}}},{key:"render",value:function(){var e=this;switch(this.state.status){case-1:default:return d.a.createElement("span",null,"Error!");case 0:return d.a.createElement(P,null);case 1:return d.a.createElement("div",{className:"accWrapper"},d.a.createElement(C,null),this.renderPanel(),d.a.createElement(G,{maxPages:this.state.maxPages,onPageChange:function(t){return e.setState({showPage:t})}}))}}}]),a}(d.a.Component);K.contextType=y;var V=K,z=a(20),X=a.n(z),Z=function(e){Object(o.a)(a,e);var t=Object(l.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).data=[],n.state={status:0,redirect:!1,changedData:{}},n.changedData={},n}return Object(i.a)(a,[{key:"componentDidMount",value:function(){this.getData()}},{key:"getData",value:function(){var e=this;this.setState({status:0}),this.props.match.params.id?w.getProductInfo(this.props.match.params.id).then((function(t){e.data=t,e.data.id=e.props.match.params.id,isNaN(e.data.productPrice)&&(console.error("data.productPrice was NaN, reset to 0"),e.data.productPrice=0),e.data.displayPrice=parseInt(e.data.productPrice)/100,e.setState({changedData:e.data}),e.setState({status:1})})):w.getProductList().then((function(t){e.data=t,e.setState({status:1})}))}},{key:"saveChanges",value:function(){this.savedData=this.state.changedData,this.savedData.productPrice=parseInt(JSON.parse(this.savedData.productPrice)),this.savedData.deliveryPrice=parseInt(JSON.parse(this.savedData.deliveryPrice)),w.setProductInfo(this.props.match.params.id,this.savedData)}},{key:"handleChange",value:function(e,t){var a;a="productDescription"===t?(a=(a=(a=e.target.value).replaceAll("<div>","")).replaceAll("</div>","")).replaceAll("<br>","\n"):e.target.value,this.setState({changedData:Object(O.a)(Object(O.a)({},this.state.changedData),{},Object(N.a)({},t,JSON.stringify(a)))})}},{key:"uploadFile",value:function(e){var t=this;w.setProductImage(this.props.match.params.id,e).then((function(e){return e.ref.getDownloadURL()})).then((function(e){t.setState({changedData:Object(O.a)(Object(O.a)({},t.state.changedData),{},{image:e})}),t.data.image=t.state.changedData.image,t.saveChanges()})).catch(console.error)}},{key:"renderItem",value:function(){var e=this;if(1===this.state.status)return null!==this.data?d.a.createElement("div",{className:"storeItemPageWrapper"},d.a.createElement(C,null),d.a.createElement("div",{className:"sipWrapper"},d.a.createElement("div",{className:"sipLeft"},d.a.createElement(X.a,{html:JSON.parse(this.state.changedData.productName),onChange:function(t){return e.handleChange(t,"productName")},className:"sipName"}),d.a.createElement("br",null),d.a.createElement("img",{onClick:function(){return window.open(e.state.changedData.image,"popup","scrollbars=no")},className:"sipImage",src:this.state.changedData.image,alt:"".concat(this.state.changedData.productName)}),d.a.createElement("input",{type:"file",onChange:function(t){return e.uploadFile(t)}})),d.a.createElement("div",{className:"sipRight"},d.a.createElement("div",{className:"sipInfo"},d.a.createElement(X.a,{className:"pedDesc",onChange:function(t){return e.handleChange(t,"productDescription")},html:JSON.parse(this.state.changedData.productDescription).replaceAll("\n","<br>")}),d.a.createElement("div",{className:"sipBuyBox"},d.a.createElement("div",{className:"sipBoxPrice"},d.a.createElement("span",{className:"sipPrice"},"\xa3",d.a.createElement(X.a,{html:""+JSON.parse(this.state.changedData.productPrice),onChange:function(t){return e.handleChange(t,"productPrice")},tagName:"span"})),d.a.createElement("br",null),d.a.createElement("span",{className:"sipItemPP"},"(\xa3",d.a.createElement(X.a,{html:""+JSON.parse(this.state.changedData.deliveryPrice),onChange:function(t){return e.handleChange(t,"deliveryPrice")},tagName:"span"}),"P&P)"))),d.a.createElement("div",{className:"sipBuyWrapper"},d.a.createElement("button",{className:"sipBuyButton",onClick:function(){return e.saveChanges()}},"Save Changes")))))):d.a.createElement("div",{className:"productEditorPage"},"No product found")}},{key:"addNewProduct",value:function(){var e=Object(s.a)(r.a.mark((function e(){var t,a;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={productName:'""',productDescription:'""',Catagory:'""',deliveryPrice:0,productPrice:0,sku:'""',image:'""',unitPerDeliveryCharge:0},e.next=3,b.firestore().collection("productList").add(t);case 3:return a=e.sent,e.abrupt("return",d.a.createElement(v.a,{to:"/editor/".concat(a.id)}));case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"renderSelector",value:function(){var e=this;return d.a.createElement("div",{className:"productEditorPage"},d.a.createElement(C,null),d.a.createElement("div",{className:"productEditorPageWrapper"},d.a.createElement("span",{className:"productEditorListTitle"},"Edit specific product"),this.data.map((function(e,t){return d.a.createElement("div",{key:t,className:"productEditorListContainer"},d.a.createElement(h.b,{key:t,to:"/editor/".concat(e.id)},d.a.createElement("span",{className:"productEditorListName"},e.productName),d.a.createElement("br",null),d.a.createElement("span",{className:"productEditorListID"},"[",e.id,"]")))})),d.a.createElement("br",null),d.a.createElement("button",{className:"productEditorListAddButton",onClick:function(){return e.addNewProduct()}},"Add new item")))}},{key:"render",value:function(){return 0===this.state.status?d.a.createElement("div",{className:"productEditorPage"},"Loading product information"):this.props.match.params.id?this.renderItem():this.renderSelector()}}]),a}(d.a.Component);Z.contextType=y;var $=Z,ee=function(e){Object(o.a)(a,e);var t=Object(l.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).state={orderStatus:["Placed","Dispatched","Out for delivery","Complete","Returned"],status:-1,showPage:0,maxPages:2},n}return Object(i.a)(a,[{key:"componentDidUpdate",value:function(){void 0!==this.context&&void 0!==this.context.currentUser&&null!==this.context&&null!==this.context.currentUser&&void 0!==this.context.storeData&&void 0!==this.context.storeData[0]&&void 0!==this.context.storeData[1]&&-1===this.state.status&&void 0===this.state.orderData&&this.getInfo()}},{key:"componentDidMount",value:function(){void 0!==this.context&&void 0!==this.context.currentUser&&null!==this.context&&null!==this.context.currentUser&&void 0!==this.context.storeData&&void 0!==this.context.storeData[0]&&void 0!==this.context.storeData[1]&&-1===this.state.status&&void 0===this.state.orderData&&this.getInfo()}},{key:"getInfo",value:function(){var e=Object(s.a)(r.a.mark((function e(){var t=this;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===this.context||void 0===this.context.currentUser||null===this.context||null===this.context.currentUser||void 0===this.context.storeData||void 0===this.context.storeData[0]||void 0===this.context.storeData[1]||-1!==this.state.status){e.next=3;break}if(void 0===this.state.orderData){e.next=3;break}return e.abrupt("return");case 3:return this.setState({orderData:[],status:0}),e.next=6,w.getAdminData().then((function(e){t.setState({openOrders:e},(function(){t.state.openOrders.map(function(){var e=Object(s.a)(r.a.mark((function e(a,n){var c;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(c=t.state.orderData).push([]),t.setState({orderData:c},(function(){a.data.map(function(){var e=Object(s.a)(r.a.mark((function e(a){var s;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=JSON.parse(a).key,e.next=3,w.getProductInfo(s).then((function(e){var a=t.state.orderData;a[n].push(e),t.setState({orderData:a})}));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}));case 3:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}())}))}));case 6:this.setState({columnSettings:this.context.storeData[1],status:1});case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"advanceFullfillment",value:function(e){var t=this,a=this.state.openOrders[e];a.status<3&&w.advanceOrder(a).then((function(){t.setState({status:-1})}))}},{key:"handleSettingsChange",value:function(e){this.setState({columnSettings:Object(O.a)(Object(O.a)({},this.state.columnSettings),{},Object(N.a)({},e.target.name,e.target.value.replace(/\n/g,"")))})}},{key:"saveSettings",value:function(){w.saveSettings(this.state.columnSettings)}},{key:"makeRefund",value:function(){var e=Object(s.a)(r.a.mark((function e(t,a){var n,s,c=this;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("http://localhost:4242/make-refund",{method:"POST",body:btoa(a)});case 2:return n=e.sent,e.next=5,n.json();case 5:if("failed"!==(s=e.sent).status){e.next=11;break}return alert("Unable to refund, "+s.reason),e.abrupt("return");case 11:w.setOrderRefunded(t).then((function(){c.setState({status:-1})}));case 12:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}()},{key:"renderColumnSettings",value:function(e){var t=this;return d.a.createElement("div",{className:"admColumnSettings"+e},d.a.createElement("span",{className:"admColumnSettingsTitle"},e," Column Settings"),d.a.createElement("br",null),d.a.createElement("div",{className:"admColumnSettingImage"},d.a.createElement("label",{htmlFor:"ColumnImage"+e},"Image Link for ",e," Column"),d.a.createElement("textarea",{type:"text",className:"admColumnSettingsInputLink",name:"ColumnImage"+e,id:"ColumnImage"+e,onChange:function(e){return t.handleSettingsChange(e)},value:this.state.columnSettings["ColumnImage"+e]}),d.a.createElement("br",null)),d.a.createElement("div",{className:"admColumnSettingAlt"},d.a.createElement("label",{htmlFor:"ColumnAlt"+e},"Alt text for ",e," Column"),d.a.createElement("input",{type:"text",className:"admColumnSettingsInput",name:"ColumnAlt"+e,id:"ColumnAlt"+e,onChange:function(e){return t.handleSettingsChange(e)},value:this.state.columnSettings["ColumnAlt"+e]}),d.a.createElement("br",null)),d.a.createElement("div",{className:"admColumnSettingLink"},d.a.createElement("label",{htmlFor:"ColumnLink"+e},"Link for ",e," Column"),d.a.createElement("input",{type:"text",className:"admColumnSettingsInput",name:"ColumnLink"+e,id:"ColumnLink"+e,onChange:function(e){return t.handleSettingsChange(e)},value:this.state.columnSettings["ColumnLink"+e]}),d.a.createElement("br",null)),d.a.createElement("div",{className:"admColumnSettingColor"},d.a.createElement("label",{htmlFor:"ColumnBackground"+e},"Background Color for ",e," Column"),d.a.createElement("input",{type:"color",className:"admColumnSettingsInput",name:"ColumnBackground"+e,id:"ColumnBackground"+e,onChange:function(e){return t.handleSettingsChange(e)},value:this.state.columnSettings["ColumnBackground"+e]}),d.a.createElement("br",null)))}},{key:"renderPanel",value:function(){var e=this;switch(this.state.showPage){default:return d.a.createElement(P,null);case 0:return 0===this.state.openOrders.length?d.a.createElement("div",{className:"admPanel"},"No current open orders."):d.a.createElement("div",{className:"admPanel"},this.state.openOrders.map((function(t,a){return d.a.createElement("div",{key:a,className:"admOI"},d.a.createElement("div",{className:"admOITitle"},"Order #",a+1),d.a.createElement("div",{className:"admOIBio"},d.a.createElement("div",{className:"admOIBioTitle"},"Recipient Information"),d.a.createElement("div",{className:"admOIName"},"Name: ",t.name),d.a.createElement("div",{className:"admOIEmail"},d.a.createElement("a",{href:"mailto:"+t.email},"Email: ",t.email))),d.a.createElement("div",{className:"admOIAddress"},d.a.createElement("div",{className:"admOIAddressTitle"},"Shipping Address"),d.a.createElement("span",{className:"admOIAddressLine"},t.address.line1),d.a.createElement("br",null),null!==t.address.line2&&d.a.createElement("span",{className:"admOIAddressLine"},t.address.line2),d.a.createElement("span",{className:"admOIAddressLine"},t.address.city),d.a.createElement("br",null),d.a.createElement("span",{className:"admOIAddressLine"},t.address.postcode),d.a.createElement("br",null)),d.a.createElement("div",{className:"admOIItems"},e.state.orderData[a].map((function(e){return d.a.createElement("div",{className:"AdmOIItems"},JSON.parse(e.productName))}))),d.a.createElement("div",{className:"admOIStatus"},d.a.createElement("span",{className:"admOIStatusText"},"Status: ",e.state.orderStatus[t.status]),d.a.createElement("br",null),d.a.createElement("button",{className:"admOIAdvanceOrder",disabled:t.status>=3,onClick:function(){return e.advanceFullfillment(a)}},t.status>=3&&d.a.createElement("b",null,"Completed Order"),t.status<3&&d.a.createElement("b",null,"Advance to ",e.state.orderStatus[t.status+1])),d.a.createElement("br",null),d.a.createElement("button",{className:"admOIRefund",onClick:function(){return e.makeRefund(t.id,t.pid)}},"Issue Refund")))})));case 1:return d.a.createElement("div",{className:"admPanel"},d.a.createElement("div",{className:"admPanelColumnSettings"},d.a.createElement("div",null,d.a.createElement("label",{htmlFor:"StoreTitle"},"Store Title"),d.a.createElement("br",null),d.a.createElement("input",{type:"text",name:"StoreTitle",id:"StoreTitle",onChange:function(t){return e.handleSettingsChange(t)},value:this.state.columnSettings.StoreTitle})),d.a.createElement("div",{className:"admColumnSettingsWrapper"},this.renderColumnSettings("Left"),this.renderColumnSettings("Center"),this.renderColumnSettings("Right")),d.a.createElement("button",{onClick:function(){return e.saveSettings()}},"Save Changes")))}}},{key:"render",value:function(){var e=this;switch(this.state.status){case-1:case 0:default:return d.a.createElement(P,null);case 1:return d.a.createElement("div",{className:"admWrapper"},d.a.createElement(C,null),this.renderPanel(),d.a.createElement(G,{maxPages:this.state.maxPages,onPageChange:function(t){return e.setState({showPage:t})}}))}}}]),a}(d.a.Component);ee.contextType=y;var te=ee,ae=function(e){Object(o.a)(a,e);var t=Object(l.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).statusTitles=["Placed","Dispatched","Out for delivery","Complete","Returned"],n.statusDescriptions=["Placed, in the system ready to be dispatched","Dispatched, ready to be sent out for delivery","Out for delivery, with our postal carrier","Completed, order has been recieved","Refunded, Sorry if there was a problem with your order"],n.state={status:0,id:n.props.match.params.id,productInfo:{}},n}return Object(i.a)(a,[{key:"componentDidUpdate",value:function(){var e=this;void 0!==this.context&&void 0!==this.context.storeData&&0===this.state.status&&w.getUserOrder(this.state.id).then((function(t){if(void 0===t)e.setState({status:-1});else{var a="",n=t.created.toDate();a=["January","February","March","April","May","June","July","August","September","October","November","December"][n.getMonth()]+" "+n.getDate(),n.getDate().toString().endsWith("1")?a+="st ":n.getDate().toString().endsWith("2")?a+="nd ":n.getDate().toString().endsWith("3")?a+="rd ":a+="th ",a+=n.getFullYear(),e.setState({orderData:Object(O.a)(Object(O.a)({},t),{},{dateString:a})});for(var r=function(a){var n=JSON.parse(t.data[a]);w.getProductInfo(n.key).then((function(r){var s=JSON.parse(JSON.stringify(e.state.productInfo));s=Object(O.a)(Object(O.a)({},s),{},Object(N.a)({},n.key,Object(O.a)(Object(O.a)({},r),{},{productName:JSON.parse(r.productName),Catagory:JSON.parse(r.Catagory),productDescription:JSON.parse(r.productDescription),sku:JSON.parse(r.sku)}))),e.setState({productInfo:s},(function(){a===t.data.length-1&&e.setState({status:1})}))}))},s=0;s<t.data.length;s++)r(s)}}))}},{key:"render",value:function(){var e=this;switch(this.state.status){case-1:default:return d.a.createElement("div",{className:"vopWrapper"},d.a.createElement(C,null),d.a.createElement("div",{className:"vopPanelError"},"Error loading order information"));case 0:return d.a.createElement("div",{className:"vopWrapper"},d.a.createElement(C,null),d.a.createElement(P,null));case 1:return d.a.createElement("div",{className:"vopWrapper"},d.a.createElement(C,null),d.a.createElement("div",{className:"vopPanelTitle"},"About your order placed ",d.a.createElement("span",null,this.state.orderData.dateString)),d.a.createElement("div",{className:"vopPanelStatus"},d.a.createElement("span",{className:"vopPanelStatusBig"},"Your order is ",this.statusTitles[this.state.orderData.status]),d.a.createElement("br",null),d.a.createElement("span",{className:"vopPanelStatusSmall"},this.statusDescriptions[this.state.orderData.status])),d.a.createElement("div",{className:"vopPanelShipping"},d.a.createElement("span",{className:"vopPanelInnerTitle"},"Shipping Address"),d.a.createElement("br",null),d.a.createElement("span",null,this.state.orderData.address.name),d.a.createElement("br",null),d.a.createElement("span",null,this.state.orderData.address.line1),d.a.createElement("br",null),null!==this.state.orderData.address.line2?d.a.createElement("span",null,this.state.orderData.address.line2):d.a.createElement("span",null),d.a.createElement("br",null),d.a.createElement("span",null,this.state.orderData.address.city),d.a.createElement("br",null),d.a.createElement("span",null,this.state.orderData.address.postcode),d.a.createElement("br",null)),d.a.createElement("div",{className:"vopPanelItems"},d.a.createElement("span",{className:"vopPanelInnerTitle"},"Order Items"),this.state.orderData.data.map((function(t,a){var n=JSON.parse(t);return d.a.createElement("div",{key:a,className:"vopPanelOrderItem"},d.a.createElement("span",{className:"vopPanelOrderItemTitle"},"(x",n.quantity,") ",e.state.productInfo[n.key].productName),d.a.createElement("span",{className:"vopPanelOrderItemPrice"},"\xa3",e.state.productInfo[n.key].displayPrice," + (\xa3",(e.state.productInfo[n.key].deliveryPrice/100).toFixed(2)," P&P)"))}))),d.a.createElement("div",{className:"vopPanelTotal"},"Order Total: \xa3",(this.state.orderData.paid/100).toFixed(2)))}}}]),a}(d.a.Component);ae.contextType=y;var ne=ae,re=function(e){Object(o.a)(a,e);var t=Object(l.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).dataList=[],n.state={status:0},null===window.localStorage.getItem("basket")&&window.localStorage.setItem("basket",JSON.stringify([])),n}return Object(i.a)(a,[{key:"componentDidMount",value:function(){var e=this;this.setState({status:0}),this.loadData().then((function(t){e.dataList=t,e.setState({status:1})}))}},{key:"loadData",value:function(){var e=Object(s.a)(r.a.mark((function e(){var t,a,n;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b.firestore().collection("storeSettings").get();case 2:return t=e.sent,a=t.docs.map((function(e){return e.data()})),n=t.docs.map((function(e){return e.id})),a.map((function(e,t){return a[t].id=n[t]})),e.abrupt("return",a);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){return 0===this.state.status||null===this.context.storeData?d.a.createElement("div",{className:"Wrapper"},"Loading data..."):d.a.createElement(k,null,d.a.createElement(h.a,null,d.a.createElement(v.b,{path:"/",exact:!0,component:Q}),d.a.createElement(v.b,{path:"/basket",exact:!0,component:q}),d.a.createElement(v.b,{path:"/success",exact:!0,component:U}),d.a.createElement(v.b,{path:"/cancel",exact:!0,component:F}),d.a.createElement(v.b,{path:"/products/:id?",exact:!0,component:J}),d.a.createElement(v.b,{path:"/signin",exact:!0,component:_}),d.a.createElement(v.b,{path:"/account",exact:!0,component:V}),d.a.createElement(v.b,{path:"/editor/:id?",exact:!0,component:$}),d.a.createElement(v.b,{path:"/admin",exact:!0,component:te}),d.a.createElement(v.b,{path:"/account/order/:id?",component:ne})))}}]),a}(d.a.Component);p.a.render(d.a.createElement(re,null),document.getElementById("root"))}},[[34,1,2]]]);
//# sourceMappingURL=main.d9fd1ef9.chunk.js.map